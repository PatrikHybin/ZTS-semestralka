*** Settings ***
Documentation                                      This is a price ordering test
Library                                            SeleniumLibrary
Library     String
Library     Collections

*** Variables ***
${url}                                              https://www.alza.sk
${browser}                                          chrome
${search}       xpath=//*[@id="edtSearch"]
${btnSearch}    xpath=//*[@id="btnSearch"]
${orderByMin}       xpath=//*[@id="ui-id-6"]
${orderByHigh}      xpath=//*[@id="ui-id-5"]
${max}      10000000
${min}      0
${minPrice}     400
${maxPrice}     800
${minPriceInput}        xpath=//*[@id="parametrization"]/div[1]/div[1]/div[2]/input[1]
${maxPriceInput}         xpath=//*[@id="parametrization"]/div[1]/div[1]/div[2]/input[2]
*** Test Cases ***
Poúžívateľ vyhľadá položky a následne ich zoradí podľa ceny vzostupne
    open browser                                    ${URL}    ${browser}
    maximize browser window
    Wait Until Element Is Visible                   ${search}
    input text                                      ${search}   pracka
    click element                                   ${btnSearch}
    Wait Until Element Is Visible                   ${orderByMin}
    click element                                   ${orderByMin}
    sleep  2s
    ${xpath}=   Set Variable   //*[@id="boxes"]/div/div[2]/div[1]/div/span[1]
    ${count}=  Get Element Count    ${xpath}
    FOR   ${index}     IN RANGE     ${count}
        ${price}=  Get Text  //*[@id="boxes"]/div[${index}+1]/div[2]/div[1]/div/span[1]
        ${price}=  Fetch from left     ${price}     €
        ${price}=  Fetch from right    ${price}    Od
        ${price}=  Fetch from left     ${price}     ,
        ${price}=     Convert To Number   ${price}
        ${min}=     Convert To Number   ${min}
        ${status}=	 Run Keyword And Return Status    Should Be True	${price} >= ${min}
        Run Keyword If
        ...    ${status}
        ...    Log to Console   \nPriceViacAkoMin
        ...    ELSE
        ...    Log To Console   FAIL Price is not in set limit
        ${min}=  Set Variable   ${price}

    END

    close browser

Poúžívateľ vyhľadá položky a následne ich zoradí podľa ceny zostupne
    open browser                                    ${URL}    ${browser}
    maximize browser window
    Wait Until Element Is Visible                   ${search}
    input text                                      ${search}  notebook
    click element                                   ${btnSearch}
    Wait Until Element Is Visible                   ${orderByHigh}
    click element                                   ${orderByHigh}
    sleep  2s
    ${xpath}=   Set Variable   //*[@id="boxes"]/div/div[2]/div[1]/div/span[1]
    ${count}=  Get Element Count    ${xpath}
    FOR   ${index}     IN RANGE     ${count}
        ${price}=  Get Text  //*[@id="boxes"]/div[${index}+1]/div[2]/div[1]/div/span[1]
        ${price}=  Fetch from left     ${price}     €
        ${price}=  Fetch from right    ${price}    Od
        ${price}=  Fetch from left     ${price}     ,
        ${price}=   Convert To Number   ${price}
        ${max}=   Convert To Number   ${max}
        ${status}=	 Run Keyword And Return Status    Should Be True	${price} <= ${max}
        Run Keyword If
        ...    ${status}
        ...    Log to Console   \nPriceMenejAkoMax
        ...    ELSE
        ...    Log To Console    FAIL Price is not in set limit
        ${max}=  Set Variable   ${price}

    END

    close browser

Poúžívateľ vyhľadá položky a následne urči cenový rozsah
    open browser                                    ${URL}    ${browser}
    maximize browser window
    Wait Until Element Is Visible                   ${search}
    input text                                      ${search}  notebook
    click element                                   ${btnSearch}
    Wait Until Element Is Visible                   ${orderByMin}
    click element           ${minPriceInput}
    input text              ${minPriceInput}  ${minPrice}  False
    Wait Until Element Is Visible             ${orderByMin}
    sleep  1s
    click element           ${maxPriceInput}
    input text              ${maxPriceInput}  ${maxPrice}  False
    click element    xpath=//*[@id="h1c"]/h1
    Wait Until Element Is Visible             ${orderByMin}
    sleep  2s
    ${xpath}=   Set Variable   //*[@id="boxes"]/div/div[2]/div[1]/div/span[1]
    ${count}=  Get Element Count    ${xpath}

    FOR   ${index}     IN RANGE     ${count}
        ${price}=   Get Text  //*[@id="boxes"]/div[${index}+1]/div[2]/div[1]/div/span[1]
        ${price}=   Fetch from left     ${price}     €
        ${price}=   Fetch from right    ${price}    Od
        ${price}=   Fetch from left     ${price}     ,
        ${price}=   Convert To Number   ${price}
        ${minPrice}=  Convert To Number   ${minPrice}
        ${maxPrice}=  Convert To Number   ${maxPrice}
        ${status}=	 Run Keyword And Return Status    Should Be True	${minPrice} <= ${price} <= ${maxPrice}
        Run Keyword If
        ...    ${status}
        ...    Log to Console   \nPriceJeVMINaMAX
        ...    ELSE
        ...    Log To Console    FAIL Price is not in set range
    END

    close browser


*** Keywords ***
